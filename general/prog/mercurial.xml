<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY mercurial-download-http "https://www.mercurial-scm.org/release/mercurial-&mercurial-version;.tar.gz">
  <!ENTITY mercurial-download-ftp  "">
  <!ENTITY mercurial-md5sum        "37f5c2c5efee02fe25a0f344b2e3ca72">
  <!ENTITY mercurial-size          "7,7 MB">
  <!ENTITY mercurial-buildsize     "79 MB (com os documentos, adicionar 892 MB para os testes)">
  <!ENTITY mercurial-time          "0,3 UPC (com os documentos, adicionar 6,2 UPC para os testes usando &quot;-j4&quot;)">
]>

<sect1 id="mercurial" xreflabel="Mercurial-&mercurial-version;">
  <?dbhtml filename="mercurial.html"?>


  <title>Mercurial-&mercurial-version;</title>

  <indexterm zone="mercurial">
    <primary sortas="a-mercurial">mercurial</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introdução ao "Mercurial"</title>

    <para>
      <application>Mercurial</application> é uma ferramenta de gerenciamento
distribuído de controle de fonte semelhante ao
<application>Git</application> e ao
<application>Bazaar</application>. <application>Mercurial</application> é
escrita em <application>Python</application> e é usada por projetos como
"Mozilla" para "Firefox" e "Thunderbird".
    </para>

    &lfs113_checked;

    <bridgehead renderas="sect3">Informação do Pacote</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Transferência (HTTP): <ulink url="&mercurial-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Transferência (FTP): <ulink url="&mercurial-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Soma de verificação MD5 da transferência: &mercurial-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Tamanho da transferência: &mercurial-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Espaço em disco estimado exigido: &mercurial-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Tempo de construção estimado: &mercurial-time;
        </para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Dependências do "Mercurial"</bridgehead>

    <bridgehead renderas="sect4">Opcionais</bridgehead>
    <para role="optional">
    <xref linkend="docutils"/> (exigido para construir a documentação), <xref
linkend="git"/>, <xref linkend="gpgme"/> (com ligações "Python"), <xref
role="runtime" linkend="openssh"/> (tempo de execução, para acessar
repositórios "ssh://..."), <xref linkend="pygments"/>, <xref
linkend="rust"/> (veja-se <filename>rust/README.rst</filename> e
<filename>rust/rhg/README.md</filename>), <xref linkend="subversion"/> (com
ligações "Python"), <ulink url="https://launchpad.net/bzr">Bazaar</ulink>,
<ulink url="https://www.nongnu.org/cvs/">CVS</ulink>, <ulink
url="https://pypi.python.org/pypi/pyflakes">pyflakes</ulink>, <ulink
url="https://www.pyopenssl.org/en/stable/">pyOpenSSL</ulink> e <ulink
url="https://github.com/google/re2/">re2</ulink>

    </para>

    <para condition="html" role="usernotes">Observações de Usuário(a): <ulink url="&blfs-wiki;/mercurial"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Instalação do "Mercurial"</title>
    

    <!-- Rust port is now part of the standard tests -->
<para>
      Construa <application>Mercurial</application> emitindo o seguinte comando:
    </para>

<screen><userinput>make build</userinput></screen>

    <para>
      Para construir a documentação (exige <xref linkend="docutils"/>), emita:
    </para>

<screen remap="doc"><userinput>make doc</userinput></screen>

    <para>
      Para executar a suíte de teste, emita:
    </para>
<!-- The blacklists have to be checked every release of Mercurial, do a listing
     of tests/blacklists, but do not include the README. -->
<screen remap="test"><userinput>TESTFLAGS="-j<replaceable>&lt;N&gt;</replaceable> --tmpdir tmp --blacklist blacklists/fsmonitor --blacklist blacklists/linux-vfat" make check</userinput></screen>


    <para>
      <!--
      # Ran 908 tests, 65 skipped, 4 failed.  real  10m37.422s -bdubbs 6 Sep 22.
      # Ran 881 tests, 102 skipped, 23 failed. -plabs 17 Nov 22.
      # Ran 919 tests, 64 skipped, 23 failed. real  10m25.285s -bdubbs 10 Jan 23.

      -->
onde <replaceable>&lt;N&gt;</replaceable> é um número inteiro entre um e o
número de (camadas X do processador), inclusive. Vários testes (cerca de
vinte (20)) falham porque algumas mensagens de erro foram mudadas em
"Python" ou alguns avisos de descontinuação são impressos, que não estavam
presentes quando o teste foi projetado. Para a finalidade de investigar
quaisquer testes aparentemente falhos, você possivelmente use o script
<command>run-tests.py</command>. Para ver as quase quarenta chaves, algumas
delas muito úteis, emita <command>tests/run-tests.py
--help</command>. Executando os seguintes comandos, você executará somente
os testes que falharam antes:
    </para>

<screen remap="test"><userinput>pushd tests &amp;&amp;
  rm -rf tmp &amp;&amp;
  ./run-tests.py --tmpdir tmp test-gpg.t
popd</userinput></screen>

    <para>
      Normalmente, as falhas anteriores serão reproduzíveis. Porém, se você
adicionar a chave <option>--debug</option> antes de
<option>--tmpdir</option> e executar os testes novamente, [então] algumas
falhas possivelmente desapareçam, o que é um problema com a suíte de
teste. Se isso acontecer, [então] não mais existirão falhas, mesmo se você
não passar a chave "--debug" novamente.
    </para>

    <para>
      Uma chave interessante é <option>--time</option>, que gerará uma tabela de
todos os testes executados e respectivos tempos de início, fim, usuário(a),
sistema e real assim que os testes estiverem completos. Observe que essas
chaves possivelmente sejam usadas com <command>make check</command>
incluindo-as na variável de ambiente <envar>TESTFLAGS</envar>.
    </para>

    <para>
      Instale o <application>Mercurial</application> executando o seguinte comando
(como <systemitem class="username">root</systemitem>):
    </para>

<screen role="root"><userinput>make PREFIX=/usr install-bin</userinput></screen>

    <para>
      Se você construiu a documentação, [então] instale-a executando o seguinte
comando (como <systemitem class="username">root</systemitem>):
    </para>

<screen role="root"
        remap="doc"><userinput>make PREFIX=/usr install-doc</userinput></screen>

    <para>
      Depois da instalação, dois testes muito rápidos e simples deveriam executar
corretamente. O primeiro precisa de alguma configuração:
    </para>

<screen><userinput>cat &gt;&gt; ~/.hgrc &lt;&lt; "EOF"
<literal>[ui]
username = <replaceable>&lt;nome_usuário(a)&gt; &lt;usuário(a)@correio&gt;</replaceable></literal>
EOF</userinput></screen>

    <para>
      onde você precisa substituir &lt;nome_usuário(a)&gt; e
&lt;seu@correio-eletrônico&gt; (o correio é opcional e pode ser
omitido). Com a identidade do(a) usuário(a) definida, execute <command>hg
debuginstall</command> e diversas linhas serão exibidas, a última dizendo
"no problems detected". Outro teste rápido e simples é apenas
<command>hg</command>, que deveria gerar comandos básicos que conseguem ser
usados com <command>hg</command>.
    </para>

  </sect2>



  <!--
  <sect2 role="commands">

    <title>Command Explanations</title>

      <para>
        <command>2to3 -w doc/hgmanpage.py</command>: Since <application>
        Python 3</application> is used with docutils, one file needs to be
        converted in order to be compatible.
      </para>

   </sect2>
-->
<sect2 role="configuration">
    <title>Configurando o "Mercurial"</title>

    <sect3 id="mercurial-config">
      <title>Arquivos de Configuração</title>

      <para>
        <filename>/etc/mercurial/hgrc</filename> e <filename>~/.hgrc</filename>
      </para>

      <indexterm zone="mercurial mercurial-config">
        <primary sortas="e-etc-mercurial-hgrc">/etc/mercurial/hgrc</primary>
      </indexterm>

      <indexterm zone="mercurial mercurial-config">
        <primary sortas="e-AA.hgrc">~/.hgrc</primary>
      </indexterm>

      <para>
        A maioria das extensões está desabilitada por padrão. Execute <command>hg
help extensions</command> se precisar habilitar alguma, por exemplo. ao
investigar falhas de teste. Isso exibirá uma lista de extensões habilitadas
e desabilitadas, bem como mais informações, tais como habilitar ou
desabilitar extensões usando arquivos de configuração.
      </para>

      <para>
        Se você tiver instalado o <xref linkend="make-ca"/> e deseja que o
<application>Mercurial</application> use os certificados, [então] como o(a)
usuário(a) <systemitem class="username">root</systemitem>, emita:
      </para>

<screen role="root"><userinput>install -v -d -m755 /etc/mercurial &amp;&amp;
cat &gt; /etc/mercurial/hgrc &lt;&lt; "EOF"
<literal>[web]
cacerts = /etc/pki/tls/certs/ca-bundle.crt</literal>
EOF</userinput></screen>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Conteúdo</title>

    <segmentedlist>
      <segtitle>Aplicativos Instalados</segtitle>
      <segtitle>Bibliotecas Instaladas</segtitle>
      <segtitle>Diretórios Instalados</segtitle>

      <seglistitem>
        <seg>
          hg
        </seg>
        <seg>
          vários módulos internos sob
/usr/lib/python&python3-majorver;/site-packages/mercurial
        </seg>
        <seg>
          /etc/mercurial,
/usr/lib/python&python3-majorver;/site-packages/hgdemandimport,
/usr/lib/python&python3-majorver;/site-packages/hgext,
/usr/lib/python&python3-majorver;/site-packages/hgext3rd,
/usr/lib/python&python3-majorver;/site-packages/mercurial e
/usr/lib/python&python3-majorver;/site-packages/mercurial-&mercurial-version;-py&python3-majorver;.egg-info
        </seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descrições Curtas</bridgehead>
      <?dbfo list-presentation="list"?> <?dbhtml list-presentation="table"?>

      <varlistentry id="hg">
        <term><command>hg</command></term>
        <listitem>
          <para>
            é o sistema de controle de versão "mercurial"
          </para>
          <indexterm zone="mercurial hg">
            <primary sortas="b-hg">hg</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
